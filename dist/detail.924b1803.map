{"version":3,"sources":["views/detail.js"],"names":["moment","locale","TabPane","Tabs","DPlayer","window","site","callback","key","console","log","Detail","props","_getMovieDetail","method","url","state","_id","then","movie","res","relativeMovies","video","videoKey","pic","coverKey","setState","player","container","document","getElementById","screenshot","thumbnails","catch","history","goBack","match","params","id","title","rate","backgroundColor","tags","join","meta","updateAt","fromNow","summary","map","item","posterKey","pubdate","it","i","date","format","country","Component"],"mappings":"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","file":"detail.924b1803.map","sourceRoot":"../src","sourcesContent":["import React, { Component } from 'react'\nimport { Link } from 'react-router-dom'\nimport {\n  Tabs,\n  Badge\n} from 'antd'\nimport { request } from '../lib'\nimport moment from 'moment'\nimport 'moment/locale/zh-cn'\n\nmoment.locale('zh-cn')\n\nconst TabPane = Tabs.TabPane\nconst DPlayer = window.DPlayer\nconst site = 'https://prevue.oss-cn-shenzhen.aliyuncs.com/'\n\nconst callback = (key) => {\n  console.log(key)\n}\n\nexport default class Detail extends Component {\n  constructor (props) {\n    super(props)\n\n    this.state = {\n      movie: null,\n      relativeMovies: [],\n      _id: this.props.match.params.id\n    }\n  }\n\n  componentDidMount () {\n    this._getMovieDetail()\n  }\n\n  _getMovieDetail = () => {\n    request({\n      method: 'get',\n      url: `/api/movies/${this.state._id}`\n    }).then(res => {\n      const movie = res.movie\n      const relativeMovies = res.relativeMovies\n      const video = site + movie.videoKey\n      const pic = site + movie.coverKey\n\n      this.setState({\n        movie,\n        relativeMovies\n      }, () => {\n        this.player = new DPlayer({\n          container: document.getElementById('videoPlayer'),\n          screenshot: true,\n          video: {\n            url: video,\n            pic: pic,\n            thumbnails: pic\n          }\n        })\n      })\n    }).catch(() => {\n      this.setState({\n        movie: {}\n      })\n\n      this.props.history.goBack()\n    })\n  }\n\n  render () {\n    const { movie, relativeMovies } = this.state\n\n    if (!movie) return null\n\n    return (\n      <div className='flex-row full'>\n        <div className='page-shade'>\n          <div className='video-wrapper'>\n            <div id='videoPlayer' data-src={site + movie.coverKey} data-video={site + movie.videoKey} />\n          </div>\n          <div className='video-sidebar'>\n            <Link className='homeLink' to={'/'}>回到首页</Link>\n            <Tabs defaultActiveKey='1' onChange={callback}>\n              <TabPane tab='关于本片' key='1'>\n                <h1>{movie.title}</h1>\n                <dl>\n                  <dt>豆瓣评分：<Badge count={movie.rate} style={{ backgroundColor: '#52c41a' }} /> 分</dt>\n                  <dt>电影分类：{movie.tags && movie.tags.join(' ')}</dt>\n                  <dt>更新时间：{moment(movie.meta.updateAt).fromNow()}</dt>\n                  <dt>影片介绍：</dt>\n                  <dd>{movie.summary}</dd>\n                </dl>\n              </TabPane>\n              <TabPane tab='同类电影' key='2'>\n                {\n                  relativeMovies.map(item => (\n                    <Link key={item._id} className='media' to={`/detail/${item._id}`}>\n                      <img width='60' className='align-self-center mr-3' src={site + item.posterKey} />\n                      <div class='media-body'>\n                        <h6 className='media-title'>{item.title}</h6>\n                        <ul className='list-unstyled'>\n                          {\n                            item.pubdate && item.pubdate.map((it, i) => (\n                              <li key={i}>{moment(it.date).format('YYYY.MM')} {it.country}</li>\n                            ))\n                          }\n                        </ul>\n                      </div>\n                    </Link>\n                  ))\n                }\n              </TabPane>\n            </Tabs>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n"]}